<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ov_core::InertialInitializer class | OpenVINS</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600&amp;subset=latin-ext" />
  <link rel="stylesheet" href="m-udel+documentation.compiled.css" />
  <link rel="stylesheet" href="custom.css" />
  <link rel="icon" href="favicon-light.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#2f73a3" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">OpenVINS</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="namespaceov__core.html">ov_core</a></li>
            <li><a href="namespaceov__type.html">ov_type</a></li>
            <li><a href="namespaceov__msckf.html">ov_msckf</a></li>
            <li><a href="namespaceov__eval.html">ov_eval</a></li>
            <li><a href="annotated.html">Classes</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="7">
            <li><a href="https://github.com/rpng/open_vins/">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespaceov__core.html">ov_core</a>::<wbr/></span>InertialInitializer <span class="m-thin">class</span>
        </h1>
        <p>Initializer for visual-inertial system.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
                <li><a href="#pro-attribs">Protected variables</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>This class has a series of functions that can be used to initialize your system. Right now we have our implementation that assumes that the imu starts from standing still. In the future we plan to add support for structure-from-motion dynamic initialization.</p><p>To initialize from standstill:</p><ol><li>Collect all inertial measurements</li><li>See if within the last window there was a jump in acceleration</li><li>If the jump is past our threshold we should init (i.e. we have started moving)</li><li>Use the <em>previous</em> window, which should have been stationary to initialize orientation</li><li>Return a roll and pitch aligned with gravity and biases.</li></ol>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#ab9b83aae0fe06ce3beabfc362e24d720" class="m-doc">InertialInitializer</a>(</span><span class="m-doc-wrap">double gravity_mag,
              double window_length,
              double imu_excite_threshold)</span>
            </dt>
            <dd>Default constructor.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#a6c883bb62d2a71023b6220f00d55bb86" class="m-doc">feed_imu</a>(</span><span class="m-doc-wrap">const <a href="structov__core_1_1ImuData.html" class="m-doc">ImuData</a>&amp; message)</span>
            </dt>
            <dd>Feed function for inertial data.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a8824e73db6276d9954eb597f539a6281" class="m-doc">initialize_with_imu</a>(</span><span class="m-doc-wrap">double&amp; time0,
              Eigen::Matrix&lt;double, 4, 1&gt;&amp; q_GtoI0,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; b_w0,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; v_I0inG,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; b_a0,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; p_I0inG,
              bool wait_for_jerk = true) -&gt; bool</span>
            </dt>
            <dd>Try to initialize the system using just the imu.</dd>
          </dl>
        </section>
        <section id="pro-attribs">
          <h2><a href="#pro-attribs">Protected variables</a></h2>
          <dl class="m-doc">
            <dt id="a4afb1aea20d24a0a3713c6a2e9150fff">
              Eigen::Matrix&lt;double, 3, 1&gt; <a href="#a4afb1aea20d24a0a3713c6a2e9150fff" class="m-doc-self">_gravity</a>
            </dt>
            <dd>Gravity vector.</dd>
            <dt id="affb904841eab3635252b698b85ffe4be">
              double <a href="#affb904841eab3635252b698b85ffe4be" class="m-doc-self">_window_length</a>
            </dt>
            <dd>Amount of time we will initialize over (seconds)</dd>
            <dt id="a1af4c82912928d0a58a05e62d6103141">
              double <a href="#a1af4c82912928d0a58a05e62d6103141" class="m-doc-self">_imu_excite_threshold</a>
            </dt>
            <dd>Variance threshold on our acceleration to be classified as moving.</dd>
            <dt id="ae20989e4fc3d1d7b4720359149c4df2a">
              std::vector&lt;<a href="structov__core_1_1ImuData.html" class="m-doc">ImuData</a>&gt; <a href="#ae20989e4fc3d1d7b4720359149c4df2a" class="m-doc-self">imu_data</a>
            </dt>
            <dd>Our history of IMU messages (time, angular, linear)</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="ab9b83aae0fe06ce3beabfc362e24d720"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> ov_core::<wbr />InertialInitializer::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ab9b83aae0fe06ce3beabfc362e24d720" class="m-doc-self">InertialInitializer</a>(</span><span class="m-doc-wrap">double gravity_mag,
              double window_length,
              double imu_excite_threshold)</span></span>
            </h3>
            <p>Default constructor.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">gravity_mag</td>
                  <td>Global gravity magnitude of the system (normally 9.81)</td>
                </tr>
                <tr>
                  <td>window_length</td>
                  <td>Amount of time we will initialize over (seconds)</td>
                </tr>
                <tr>
                  <td>imu_excite_threshold</td>
                  <td>Variance threshold on our acceleration to be classified as moving</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a6c883bb62d2a71023b6220f00d55bb86"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void ov_core::<wbr />InertialInitializer::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a6c883bb62d2a71023b6220f00d55bb86" class="m-doc-self">feed_imu</a>(</span><span class="m-doc-wrap">const <a href="structov__core_1_1ImuData.html" class="m-doc">ImuData</a>&amp; message)</span></span>
            </h3>
            <p>Feed function for inertial data.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">message</td>
                  <td>Contains our timestamp and inertial information</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a8824e73db6276d9954eb597f539a6281"><div>
            <h3>
              <span class="m-doc-wrap-bumper">bool ov_core::<wbr />InertialInitializer::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a8824e73db6276d9954eb597f539a6281" class="m-doc-self">initialize_with_imu</a>(</span><span class="m-doc-wrap">double&amp; time0,
              Eigen::Matrix&lt;double, 4, 1&gt;&amp; q_GtoI0,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; b_w0,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; v_I0inG,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; b_a0,
              Eigen::Matrix&lt;double, 3, 1&gt;&amp; p_I0inG,
              bool wait_for_jerk = true)</span></span>
            </h3>
            <p>Try to initialize the system using just the imu.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">time0&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Timestamp that the returned state is at</td>
                </tr>
                <tr>
                  <td>q_GtoI0&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Orientation at initialization</td>
                </tr>
                <tr>
                  <td>b_w0&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Gyro bias at initialization</td>
                </tr>
                <tr>
                  <td>v_I0inG&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Velocity at initialization</td>
                </tr>
                <tr>
                  <td>b_a0&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Acceleration bias at initialization</td>
                </tr>
                <tr>
                  <td>p_I0inG&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Position at initialization</td>
                </tr>
                <tr>
                  <td>wait_for_jerk</td>
                  <td>If true we will wait for a &quot;jerk&quot;</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>True if we have successfully initialized our system</td>
                </tr>
              </tfoot>
            </table>
<p>This will check if we have had a large enough jump in our acceleration. If we have then we will use the period of time before this jump to initialize the state. This assumes that our imu is sitting still and is not moving (so this would fail if we are experiencing constant acceleration).</p><p>In the case that we do not wait for a jump (i.e. <code>wait_for_jerk</code> is false), then the system will try to initialize as soon as possible. This is only recommended if you have zero velocity update enabled to handle the stationary cases. To initialize in this case, we need to have the average angular variance be below the set threshold (i.e. we need to be stationary).</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.16 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
